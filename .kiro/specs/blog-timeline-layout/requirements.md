# 博客时间线布局需求文档

## 项目概述

在现有博客页面基础上，通过最小化改动的方式实现时间线布局。主要通过调整现有组件的排列方式和添加时间轴视觉元素，将网格布局转换为左侧时间轴 + 右侧内容区域的设计，为用户提供更具叙事性的博客浏览体验。

## 设计原则

- **最小破坏性**：最大程度复用现有组件和样式
- **渐进增强**：在现有功能基础上添加时间线特性
- **组件复用**：优先使用项目中已有的 UI 组件
- **样式一致性**：保持与现有设计系统的完全一致

## 需求分析

### 需求 0：修复 YAML 时间读取 Bug（前置需求）

**用户故事：** 作为博客系统，我需要正确读取文章的最后修改时间，这样时间线布局才能显示准确的时间信息。

#### 验收标准

1. WHEN markdown 文件的 yaml frontmatter 中存在 date 字段 THEN 系统应使用该 date 作为文章时间
2. WHEN markdown 文件的 yaml frontmatter 中不存在 date 字段 THEN 系统应使用文件的最后修改时间（mtime）而非创建时间（birthtime）
3. WHEN 系统读取文章时间 THEN 在 getSortedPostsData() 函数中应使用 stats.mtime.toISOString()
4. WHEN 系统读取单篇文章时间 THEN 在 getPostBySlug() 函数中应使用 stats.mtime.toISOString()
5. WHEN 修复完成后 THEN 所有文章的显示时间应反映其真实的最后修改时间

#### 技术实现要点

- 修改文件：`src/lib/data/content/posts.ts`
- 修改位置：`getSortedPostsData()` 和 `getPostBySlug()` 函数中的 date 字段处理逻辑
- 将 `stats.birthtime.toISOString()` 改为 `stats.mtime.toISOString()`

### 需求 1：时间线布局设计

**用户故事：** 作为博客访问者，我希望能够通过时间线的方式浏览文章，这样我可以更直观地了解内容的发布时间顺序和发展历程。

#### 验收标准

1. WHEN 用户访问博客页面 THEN 系统应显示左侧时间轴和右侧内容区域的布局
2. WHEN 用户滚动页面 THEN 时间轴应保持固定位置，内容区域平滑滚动
3. WHEN 页面加载 THEN 时间轴应显示分块颜色的线条，不同年份使用不同色系
4. WHEN 同一天有多篇文章 THEN 该天的时间线颜色必须保持一致
5. WHEN 不同天但同一年份 THEN 应使用相近但不同的颜色

### 需求 2：时间组织和标识

**用户故事：** 作为博客访问者，我希望能够清楚地看到当前浏览内容的时间信息，这样我可以快速定位到特定时间段的文章。

#### 验收标准

1. WHEN 用户浏览时间线 THEN 左侧应固定显示年月标识（如"2024 年 1 月"）
2. WHEN 用户滚动到不同时间段 THEN 年月标识应相应更新显示当前区域的时间
3. WHEN 查看具体文章 THEN 每篇文章应显示具体的发布时间
4. WHEN 时间轴连接文章 THEN 应使用有设计感的圆点作为连接点
5. WHEN 文章重要性不同 THEN 连接点大小应根据重要性进行调整

### 需求 3：文章卡片展示

**用户故事：** 作为博客访问者，我希望文章卡片保持现有的设计风格，这样我可以获得一致的用户体验。

#### 验收标准

1. WHEN 显示文章卡片 THEN 应直接复用现有 PostCard 组件，无需修改其内部逻辑
2. WHEN 展示文章信息 THEN 应保持 PostCard 组件现有的所有功能和样式
3. WHEN 用户与卡片交互 THEN 应完全保留现有的 MagneticHover 和 BreathingAnimation 效果
4. WHEN 处理封面图显示 THEN 通过 props 控制而非修改组件内部代码
5. WHEN 用户点击卡片 THEN 应保持现有的 Link 跳转逻辑不变

### 需求 4：性能优化功能

**用户故事：** 作为博客访问者，我希望页面加载速度快且浏览流畅，这样我可以获得良好的用户体验。

#### 验收标准

1. WHEN 用户首次访问 THEN 系统应只加载初始的文章数量，不一次性加载所有文章
2. WHEN 用户滚动到页面底部附近 THEN 系统应自动加载下一批文章
3. WHEN 系统加载新内容 THEN 应使用现有的 Loading.tsx 组件显示加载状态
4. WHEN 加载过程中 THEN 用户应能继续浏览已加载的内容
5. WHEN 所有文章加载完毕 THEN 系统应停止尝试加载更多内容

### 需求 5：导航和搜索功能

**用户故事：** 作为博客访问者，我希望能够快速导航和搜索内容，这样我可以高效地找到感兴趣的文章。

#### 验收标准

1. WHEN 用户滚动页面 THEN 应显示回到顶部的猫咪图标（沿用现有设计）
2. WHEN 用户点击猫咪图标 THEN 页面应平滑滚动回到顶部
3. WHEN 用户使用搜索功能 THEN 右上角应集成开源时间搜索器
4. WHEN 用户进行时间搜索 THEN 系统应支持按时间范围筛选文章
5. WHEN 搜索完成 THEN 系统应在时间线中高亮或跳转到匹配的结果

### 需求 6：开发经验记录

**用户故事：** 作为开发团队成员，我希望每解决一个问题都能将经验总结记录下来，这样团队可以积累知识并避免重复犯错。

#### 验收标准

1. WHEN 开发过程中遇到技术问题 THEN 解决后应将经验总结到 posts/Learn.md 文档中
2. WHEN 实现新功能或修复 Bug THEN 应记录关键技术点、解决方案和经验教训
3. WHEN 发现设计或架构问题 THEN 应记录问题根源、解决过程和最佳实践
4. WHEN 完成重要里程碑 THEN 应总结整个实现过程的经验和反思
5. WHEN 遇到性能或用户体验问题 THEN 应记录优化方案和效果评估

## 技术约束

- **严格复用现有组件**：PostCard、Badge、Loading、MagneticHover、BreathingAnimation 等组件不得修改
- **最小化新增代码**：优先通过组合现有组件实现新功能
- **保持现有 API**：不修改现有组件的 props 接口和使用方式
- **样式系统一致**：使用现有的 Tailwind CSS 类和设计 token
- **技术栈不变**：基于现有的 Next.js 15 + TypeScript 架构
- **渐进式实现**：可以分阶段实现，确保每个阶段都不破坏现有功能
- **暂不考虑移动端适配**
- **暂不考虑复杂的可访问性功能**

## 现有组件复用清单

- **PostCard 组件**：完全复用，仅通过布局调整位置
- **Badge 组件**：用于文章标签显示
- **Loading 组件**：用于懒加载状态显示
- **MagneticHover 组件**：保持现有交互效果
- **BreathingAnimation 组件**：保持现有动画效果
- **BentoGrid 组件**：可参考其布局逻辑，但不强制使用

## 验收标准总结

- **组件复用**：现有 PostCard、Badge、Loading 等组件完全不变
- **布局实现**：时间线布局正确显示，左侧时间轴固定，右侧内容滚动
- **视觉效果**：颜色系统按年份随机分配，同年份内相近色彩，同一天颜色一致
- **交互保持**：所有现有的动画和交互效果完全保留
- **性能优化**：懒加载和无限滚动功能正常工作
- **功能集成**：搜索和导航功能集成完整
- **破坏性最小**：整体实现对现有代码的修改最小化
- **经验记录**：开发过程中的所有重要经验都记录到 Learn.md 文档中
